function __getClass(e){return Object.prototype.toString.call(e).match(/^\[object\s(.*)\]$/)[1]}function __obj2str(e){!function t(e){var r=[];if("string"==typeof e||null==e)return e;if("object"==typeof e){if(e.sort){r[0]="[";for(var i=0;i<e.length;i++)r[r.length]=t(e[i]),r[r.length]=",";r[r.length-1]="]"}else{r[0]="{";for(var i in e)r[r.length]=i,r[r.length]=":",r[r.length]=t(e[i]),r[r.length]=",";r[r.length-1]="}"}return r.join("")}return e.toString()}(e)}function __arg2arr(e){return Array.prototype.slice.call(e)}function init(e,t,r){function i(e,t){if(t){var i=c.shift();h[i]=t,p.push(t)}if(u.length>0)b=u.shift(),n(b);else{for(var a in h)o[a]=h[a];if(u=[],c=[],p=[],f.length>0)for(var s,l,m,g=0;g<f.length;g++)!function(e){if(m=f[e],"Function"==__getClass(d[e]))o[m]=d[e];else if("Array"==__getClass(d[e]))if("null"==m){for(var t=d[e],r=0;r<t.length;r++)if("Function"!==__getClass(t[r]))return tips("null后的数组元素必须为函数","alert"),!1;for(var r=0;r<t.length;r++)!function(e){t[e].apply(o)}(r)}else m=f[e],s=d[e][0],l=d[e].slice(1),o[m]=s;l&&l.length>0?do_action(m,l):do_action(m)}(g);r&&r.apply(o)}}function n(e){$.ajax({url:e.url,dataType:e.type,data:e.data,type:e.method,async:e.async,success:function(e){e&&""!=e||(e={}),i(null,e)},error:function(e){e&&""!=e||(e={}),i(null,e)}})}var a,s,o=e==window?e:function(){return window.context=e,window.context}(),l={url:"",method:"post",data:"",type:"json",async:!0},u=[],c=[],p=[],d=[],f=[],h={};for(var m in t)if("Object"==__getClass(t[m]))if(t[m].jquery){var g=t[m];o.views[m]=g}else t[m].nodeType?o.views[m]=t[m]:(a=t[m],a.url&&""!=a.url?(s=$.extend({},l,a),s.vari=m,u.push(s),c.push(m)):o[m]=t[m]);else if("Function"==__getClass(t[m])){var v=t[m];d.push(v),f.push(m),add_action(m,v,v.length,o)}else if("Array"==__getClass(t[m])){var _=t[m];if("Function"!==__getClass(_[0]))return;d.push(_),f.push(m),"null"!==m&&add_action(m,_,_[0].length,o)}else o[m]=t[m];var b;i()}function do_action(e){var t,r,i=[],n=[],a=!1,s=__arg2arr(arguments);if(actmap.containsKey(e)&&(i=actmap.get(e),i.length>0))for(var o=0;o<i.length;o++){if(t=i[o],"Function"!==__getClass(t.fun)){if("Function"!==__getClass(t.fun[0]))return;for(var l=1;l<t.fun.length;l++)"Function"!==__getClass(t.fun[l])&&(a=!0);if(!a){"ve"==t.ctx&&(t.ctx=window);for(var u=0;u<t.fun.length;u++)t.fun[u].apply(t.ctx);return}r=t.fun[1],"Array"!==__getClass(r)&&(n.push(r),r=n),t.fun=t.fun[0]}t.propnum&&t.propnum>0?(s=r?r:s.splice(1,1+t.propnum),"ve"==t.ctx&&(t.ctx=window),t.ctx[e]=t.fun.apply(t.ctx,s)):t.ctx[e]=t.fun.apply(t.ctx)}}function add_action(e,t,r,i){if("Function"==__getClass(t)||"Array"==__getClass(t)){var n=[],a={},s=!1;if(i&&i!=window||(i="ve"),r=r?0==r?1:r:1,actmap.containsKey(e)){n=actmap.get(e);for(var o=0;o<n.length;o++)"Array"==__getClass(t)?__obj2str(n[o].fun)==__obj2str(t[0])&&(s=!0):__obj2str(n[o])==__obj2str(t)&&(s=!0);0==s&&(a.fun=t,a.propnum=r,a.ctx=i,n.push(a),actmap.put(e,n))}else a.fun=t,a.propnum=r,a.ctx=i,n.push(a),actmap.put(e,n)}}function form_valide(e){var t,r,i=!0,n=!0,a={email:/^[\.a-zA-Z0-9_=-]+@[a-zA-Z0-9_-]+(\.[a-zA-Z0-9_-]+)+$/,username:/^[a-zA-Z0-9_\u4e00-\u9fa5]+$/,verify:/^[a-z\d]{4}$/i,verify_m:/^[\d]{6}$/,mobile:/^(13[0-9]{9}|15[012356789][0-9]{8}|18[0256789][0-9]{8}|147[0-9]{8})$/,url:/^http[s]?:\/\/([\w-]+\.)+[\w-]+([\w-.\/?%&=]*)?$/,ip4:/^(25[0-5]|2[0-4]\d|[0-1]\d{2}|[1-9]?\d)\.(25[0-5]|2[0-4]\d|[0-1]\d{2}|[1-9]?\d)\.(25[0-5]|2[0-4]\d|[0-1]\d{2}|[1-9]?\d)\.(25[0-5]|2[0-4]\d|[0-1]\d{2}|[1-9]?\d)$/,notempty:/^\S+$/,qq:/^[1-9]*[1-9][0-9]*$/,idcard:/^[1-9]([0-9]{14}|[0-9]{17})$/,birthday:/^(\d{4})[\.-](\d{1,2})[\.-](\d{1,2})$/,all:/[\s\S]/,tips:tips,popmsg:!0};return e&&"Object"==__getClass(e)&&(r=$.extend({},a),a=$.extend(a,e)),function s(e,o,l,u){var c=a.tips;if(n=a.popmsg,!e)return 0==arguments.length?i:(n&&(l?c(l,"alert"):u?c(u+"不能为空","alert"):c(o+"不能为空","alert")),i=!1,function(){return 0==arguments.length?i:arguments.callee});if(o=o||"username","Function"==__getClass(a[o])){n=!1;var p=a[o];t=""==e?!1:p.call(this,e,r),t||(i=!1)}else t=""==e?!1:a[o].test(e);return t?s:(i=!1,n&&(l?c(l,"alert"):u?c(u+"数据不正确","alert"):c(o+"数据不正确","alert")),function(){return 0==arguments.length?i:arguments.callee})}}function __measureDoc(){var e=document.documentElement.clientHeight,t=document.documentElement.clientWidth,r=document.documentElement.scrollTop||document.body.scrollTop,i=document.documentElement.scrollLeft||document.body.scrollLeft;return{dw:t,dh:e,st:r,sl:i}}function getFormData(){var e={username:{ipt:__f.username,tip:$(".lo-tips")[0],ptip:""},password:{ipt:__f.password,tip:"",ptip:""},verify:{ipt:__f.verify,tip:$("#verify-tip"),ptip:""},mverify:{ipt:__f.mverify,tip:$("#u-tip"),ptip:""}};return e}function tipBehavior(e,t,r){function i(e){t?($(a).removeClass("u-error").removeClass("u-verified-err").addClass("u-verified"),$(s).removeClass("show"),$(o).removeClass("show")):(e?$(s).html(e).addClass("show"):$(s).addClass("show"),$(a).addClass("u-error").removeClass("u-verified").addClass("u-verified-err"))}var n=getFormData(),a=n[e]?n[e].ipt:"",s=n[e]?n[e].tip:"",o=n[e]?n[e].ptip:"";"username"==e&&(r?i(r):i(),t&&$(".btn-send-msg").bind("click",function(){chk["event-src"]="sendmsg",chk["msg-sendding"]||(chk["msg-sendding"]=!0,$(n.verify.ipt).trigger("blur",[!0,a.value]))})),"mverify"==e&&i(),"verify"==e&&(i(),t&&(chk.ultimate.verify=!1,chk.ultimate.submit=!1,api={url:"/",data:{ctl:"ajax",act:"check_email_and_mobile",verify:a.value,async:!1}},__pre("pre_verify",api,__aft.verify)))}function bindInputDefaultEvent(){var e,t=getFormData();$(".changeCode").bind("click",function(){var e=(new Date).getTime();$("#verify_image1").attr("src","verify.php?rand="+e)}),$(".u-ipt").bind("focus",function(){$(this).siblings(".u-placeholder").addClass("hide")}),$(".u-ipt").bind("blur",function(){this.value||$(this).siblings(".u-placeholder").removeClass("hide")}),$(".u-placeholder").click(function(){$(this).siblings(".u-ipt").trigger("focus")});for(var r in t){{t[r].ipt}!function(r){{var i,n=t[r].ipt;t[r].tip,t[r].ptip}"username"==r&&$(n).bind("blur",function(){e=formValide(chkopts)(t[r],"username")(),tipBehavior("username",e)}),"mverify"==r&&$(n).bind("blur",function(){e=formValide({popmsg:!1})(n.value,"verify_m")(),tipBehavior("mverify",e)}),"verify"==r&&$(n).bind("blur",function(){function t(){var e=$(".btn-send-msg");e.addClass("u-wait");var t=60;chk.ttt=setInterval(function(){e.html(--t),0==t&&(clearInterval(chk.ttt),chk["msg-sendding"]=!1,$(".btn-send-msg").removeClass("u-wait").html("重新发送"))},1e3),i={url:mobile_url,data:{mobile:a,code:n.value,async:!1}},__pre("pre_sendmsg",i,__aft.sendmsg)}if(arguments.length>1){var r=arguments[1],a=arguments[2];r&&a&&e&&add_action("send_mobile_msg",t)}e=formValide({popmsg:!1})(n.value,"verify")(),tipBehavior("verify",e)})}(r)}}function checkAndPostForm(){function e(){var e=!0;for(var t in chk.ultimate)chk.ultimate[t]||(e=!1);e?do_action("loginto"):(tips("请正确填写注册信息","alert"),$(".changeCode").trigger("click"))}var t=getFormData(),r=!0;r=formValide(chkopts)(t.username,"username")(),r?(setTimeout(e,600),add_action("delaySubmit",e)):tips("请正确填写登录信息","alert")}function submitLogin(){var e=getFormData(),t={email:e.username.ipt.value,user_pwd:$.base64.encode(e.password.ipt.value),auto_login:$("#agree_userterm").val(),ajax:1};$("#verify-filed").hasClass("hide")||(t.verify=e.verify.ipt.value),api={url:login_url,data:t},__pre("pre_pclogin",api,__aft.pclogin)}function submitGoBuy(){var e=getFormData(),t={email:e.username.ipt.value,user_pwd:$.base64.encode(e.password.ipt.value),auto_login:$("#agree_userterm").val(),ajax:1};$("#verify-filed").hasClass("hide")||(t.verify=e.verify.ipt.value),api={url:login_url,data:t},__pre("pre_pclogin",api,__aft.pclogin)}var md5=function(e){return e},HashMap=function(){var e=0,t=new Object;this.put=function(r,i){var n=md5(r);t[n]=i,e++},this.putAll=function(e){if("object"!=typeof e||e.sort)throw"输入类型不正确，必须是HashMap类型！";for(var t in e)this.put(t,e[t])},this.get=function(e){var r=md5(e);return t[r]?t[r]:void 0},this.remove=function(r){var i=md5(r);if(t[i]){if(0==e)return;delete t[i],e--}},this.containsKey=function(e){var r=md5(e);return t[r]?!0:!1},this.containsValue=function(e){for(var r in t)if(t[r]==e)return!0;return!1},this.clear=function(){t=new Object,e=0},this.isEmpty=function(){return 0==e},this.size=function(){return e},this.keySet=function(){var e=new Array;for(var r in t)e.push(r);return e},this.entrySet=function(){var e=new Array;for(var r in t){var i=new Object;i[r]=t[r],e.push(i)}return e},this.values=function(){var e=new Array;for(var r in t)e.push(t[r]);return e},this.each=function(e){for(var r in t)e.call(this,r,t[r])},this.toString=function(){return __obj2str(t)}},_ctx,actmap=new HashMap,tipsbox=function(){function e(e,t){var r=this.tipsItem(t),i=this.tipsBox(t);r.innerHTML=e,i.appendChild(r),this.anim(r,i)}this.pop=function(t,r,i){r||(r="normal"),e.call(this,t,r);var n=__arg2arr(arguments);n=n.slice(3),i&&add_action("do_tipsbox",i,i.length,this)},this.tipsItem=function(){},this.tipsBox=function(){},this.anim=function(e){}},__subString=function(e,t,r){for(var i=0,n="",a=/[^\x00-\xff]/g,s="",o=e.replace(a,"**").length,l=0;o>l&&(s=e.charAt(l).toString(),null!=s.match(a)?i+=2:i++,!(i>t));l++)n+=s;return r&&o>t&&(n+="..."),n},urlparse=function(e){var t=document.createElement("a");return t.href=e,{source:e,protocol:t.protocol.replace(":",""),host:t.hostname,port:t.port,query:t.search,params:function(){for(var e,r={},i=t.search.replace(/^\?/,"").split("&"),n=i.length,a=0;n>a;a++)i[a]&&(e=i[a].split("="),r[e[0]]=e[1]);return r}(),file:(t.pathname.match(/\/([^\/?#]+)$/i)||[,""])[1],hash:t.hash.replace("#",""),path:t.pathname.replace(/^([^\/])/,"/$1"),relative:(t.href.match(/tps?:\/\/[^\/]+(.+)/)||[,""])[1],segments:t.pathname.replace(/^\//,"").split("/")}},msgtips=function(e,t,r){var i,n,a=__measureDoc(),s=(a.sl,a.st,a.dw),o=a.dh,l=new tipsbox;l.tipsItem=function(e){var t=document.createElement("div"),r=(document.createElement("div"),"background-color:#4ba2f9;");return t.className="showmsg","alert"==e&&(r="background-color:rgb(211, 13, 21);"),t.style.cssText="display:none;width:100%;text-align:center; margin-top:10px;color:#fff;line-height:40px;font-size:16px;"+r,t},l.tipsBox=function(e){return i=Math.round((parseInt(s)-300)/2),n="top:0;","alert"==e&&(n=Math.round((parseInt(o)-150)/2),n="top:"+n+"px;height:200px;overflow:hidden;"),$("#msgcontainer").length?"":$("body").append('<div id="msgcontainer" style="z-Index:10030;width:300px;position:fixed;top:10px;'+n+"left:"+i+'px;"></div>'),$("#msgcontainer")[0]},l.anim=function(e,t){clearTimeout(r),$(e).fadeIn("slow").delay(2e3).animate({height:0,opacity:0,margin:0},300);var r=setTimeout(function(){$(e).remove(),0==$(".showmsg").length&&$(t).remove(),do_action("do_tipsbox")},3e3)},r?l.pop(e,t,r):l.pop(e,t)};window.tips=msgtips,jQuery.base64=function(){function e(e,t){var r=a.indexOf(e.charAt(t));if(-1===r)throw"Cannot decode base64";return r}function t(t){var r,i,a=0,s=t.length,o=[];if(t=String(t),0===s)return t;if(s%4!==0)throw"Cannot decode base64";for(t.charAt(s-1)===n&&(a=1,t.charAt(s-2)===n&&(a=2),s-=4),r=0;s>r;r+=4)i=e(t,r)<<18|e(t,r+1)<<12|e(t,r+2)<<6|e(t,r+3),o.push(String.fromCharCode(i>>16,i>>8&255,255&i));switch(a){case 1:i=e(t,r)<<18|e(t,r+1)<<12|e(t,r+2)<<6,o.push(String.fromCharCode(i>>16,i>>8&255));break;case 2:i=e(t,r)<<18|e(t,r+1)<<12,o.push(String.fromCharCode(i>>16))}return o.join("")}function r(e,t){var r=e.charCodeAt(t);if(r>255)throw"INVALID_CHARACTER_ERR: DOM Exception 5";return r}function i(e){if(1!==arguments.length)throw"SyntaxError: exactly one argument required";e=String(e);var t,i,s=[],o=e.length-e.length%3;if(0===e.length)return e;for(t=0;o>t;t+=3)i=r(e,t)<<16|r(e,t+1)<<8|r(e,t+2),s.push(a.charAt(i>>18)),s.push(a.charAt(i>>12&63)),s.push(a.charAt(i>>6&63)),s.push(a.charAt(63&i));switch(e.length-o){case 1:i=r(e,t)<<16,s.push(a.charAt(i>>18)+a.charAt(i>>12&63)+n+n);break;case 2:i=r(e,t)<<16|r(e,t+1)<<8,s.push(a.charAt(i>>18)+a.charAt(i>>12&63)+a.charAt(i>>6&63)+n)}return s.join("")}var n="=",a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s="1.0";return{decode:t,encode:i,VERSION:s}}(jQuery);var __form_log=$("#login-form"),__f=__form_log[0],chk={};chk.username={},chk.ultimate={},chk["event-src"]="";var formValide=form_valide,chkopts={username:function(e,t){var r=e,i=(r.ipt,r.ipt.value),n=t.email.test(i);return chk.username={},n&&(chk.username.type="email"),n||(n=t.mobile.test(i),n&&(chk.username.type="mobile")),n},password:function(e){var t=e,r=(t.ipt,t.ipt.value),i=!0,n=r.length>7?0+(r.length>7)+(/[a-z]/.test(r)&&/[A-Z]/.test(r))+(/\d/.test(r)&&/\D/.test(r))+(/\W/.test(r)&&/\w/.test(r))+(r.length>12):0;return(r.length>20||/\s/.test(r))&&(n=0),0!=n&&n||(i=!1),chk.password={},chk.password.level=n,i}},__pre=function(e,t,r){var i={};i[e]=t,i[null]=[r],init(chk,i)},__aft={username:function(){var e=!0;if(inputs=getFormData(),ipt=inputs.username.ipt,tip=inputs.username.tip,chk.pre_username){var t=chk.pre_username;if(t.status<0)e=!1,$(tip).addClass("show");else switch(t.status){case 0:$(ipt).addClass("u-verified");break;case 1:$(tip).html("邮箱已被注册").addClass("show"),$(ipt).addClass("u-error").removeClass("u-verified");break;case 2:$(tip).html("手机已被注册").addClass("show"),$(ipt).addClass("u-error").removeClass("u-verified")}t.status>0?e=!1:(e=!0,chk.ultimate.username=e)}return e},sendmsg:function(){if(chk.pre_sendmsg){var e=chk.pre_sendmsg;tips(e.msg)}},pclogin:function(){getFormData();if(chk.pre_pclogin){var e=chk.pre_pclogin;(e.status||0==e.status)&&(1==e.status?top.location!=self.location?top.location=jump_url:(tips("登录成功，感谢有您!"),window.location=jump_url):0==e.status?(""!==e.field_name&&tipBehavior("username",!1,"用户名或密码错误"),1==e.need_verify&&$("#verify-filed").removeClass("hide")):tipBehavior("username",!1,"请输入正确的邮箱或手机号"))}$(".changeCode").trigger("click")},verify:function(){function e(){t?($(tip).removeClass("show"),$(ipt).removeClass("u-error").removeClass("u-verified-err").addClass("u-verified")):($(tip).addClass("show"),$(ipt).addClass("u-error").removeClass("u-verified").addClass("u-verified-err"),$(".changeCode").trigger("click"))}var t=!0;if(inputs=getFormData(),ipt=inputs.verify.ipt,tip=inputs.verify.tip,chk.pre_verify){var r=chk.pre_verify;0!=r.status?(t=!1,chk["event-src"]="",chk["msg-sendding"]=!1,e()):(t=!0,e(),chk.ultimate.verify=t,chk.ultimate.submit&&do_action("delaySubmit"),"sendmsg"==chk["event-src"]&&(chk["event-src"]="",do_action("send_mobile_msg")))}return t}};if(bindInputDefaultEvent(),add_action("loginto",submitLogin),add_action("logingobuy",submitLogin),$("#submit-btn-login").click(function(){chk.ultimate.submit=!0,checkAndPostForm()}),$(".plusLink").click(function(){$(".moreLinksBox").toggleClass("hide"),$(this).toggleClass("plusLinkOn")}),top.location!=self.location){$(".container").removeClass("container").removeClass("bg-reg"),$(".reg-content").removeClass("reg-content").css({"float":"none",width:"326px"}),$(".auth-tips:first").removeClass("auth-tips").addClass("auth-tips-top"),$(".auth-tips-top").addClass("hide"),$(".response").hide(),$(".response_title").removeClass("reg-title").removeClass("register-tit").html(""),$("#main").css("background","none"),$(".btn-login").remove("btn-login").addClass("login-btn"),$(".freereg-btn").removeClass("hide"),$(".freereg-btn").click(function(){$("#for-login").remove(),$("#for-gobuy").removeClass("hide"),$(".m-reg-hd").remove(),$(".m-pop-tit").html("<strong>免注册购买</strong>"),__f=$("#gobuy-form")[0],bindInputDefaultEvent()}),$.fn.tabSwitch=function(e){{var t=$.extend({objev:"click",objBtn:"a",objBox:".m-reg-bd .m-regbd-c"},e);$(this)}this.each(function(){$(this).find(t.objBtn).on(t.objev,function(){var e=$(this).index();$(this).addClass("on").siblings().removeClass("on"),$(t.objBox).eq(e).show().siblings().hide()})})};var tpl='<div class="m-pop-reg">            <div class="m-pop-c">                <div class="m-pop-tit">                    <strong>唯一优品会员</strong>                </div>                <div class="m-reg-tab">                        <div class="m-reg-hd clear">                            <a href="javascript:;" class="on">登录</a>                            <a href="javascript:;">注册</a>                        </div><div class="m-reg-bd">                            <div id="ifr_login" class="m-regbd-c m-regbd-login" style="display:block;overflow:hidden;">                            </div>                            <div id="ifr_register" class="m-regbd-c">                            </div>                        </div>                    </div>                </div>        </div>',login=$("#main"),register,pop_register_div=document.createElement("div");pop_register_div.style.cssText="display:block;overflow:hidden;";var pop_register_ifram=document.createElement("iframe");pop_register_ifram.frameBorder=0,pop_register_ifram.scrolling="no",pop_register_ifram.src="/index.php?ctl=user&act=register",pop_register_ifram.style.cssText="width:400px;height:430px;display:block;",pop_register_div.appendChild(pop_register_ifram),register=pop_register_div.outerHTML,$("body").append(tpl),$("#ifr_register").append(register),$("#ifr_login").append(login),$(".m-reg-hd").tabSwitch()}